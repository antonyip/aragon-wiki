language: python # Set the build language to Python

python: 3.6 # Set the version of Python to use

branches: 107 # Set the branch to build from

install:
    - pip install mkdocs==0.17.3 # Install the required dependencies
    - pip install mkdocs-material==2.7.3 # Install the required dependencies

before_deploy:
    - mkdocs build --verbose --clean --strict # Build a local version of the docs

deploy: # Deploy documentation to Github in the gh_pages branch
    provider: pages
    skip_cleanup: true
    github_token: $github_token
    local_dir: site

after_success:
  - git config user.name "Anton Yip";
  - git config user.email "dougal@dougalmatthews.com";
  - git remote add gh-token "https://${github_token}@github.com/antonyip/aragon-wiki.git";
  - git fetch gh-token && git fetch gh-token gh-pages:gh-pages;
  - pip install -IU -r test-requirements.txt retrace;
  - mkdocs gh-deploy -v --clean --remote-name gh-token;